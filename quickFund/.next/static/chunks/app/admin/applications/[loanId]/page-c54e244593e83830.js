(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{52329:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var l=t(12115);let a=l.forwardRef(function(e,s){let{title:t,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":a},n),t?l.createElement("title",{id:a},t):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},74484:(e,s,t)=>{Promise.resolve().then(t.bind(t,85959))},85959:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var l=t(95155),a=t(12115),n=t(35695),i=t(57884),r=t(39072),c=t(245),d=t(27993),o=t(52329),x=t(23571),m=t(1534);let p=a.forwardRef(function(e,s){let{title:t,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":l},n),t?a.createElement("title",{id:l},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))});var h=t(90300),j=t(45995),b=t(22264);function u(){let e=(0,n.useParams)(),s=(0,n.useRouter)(),t=e.loanId,[u,N]=(0,a.useState)(null),[g,v]=(0,a.useState)([]),[f,y]=(0,a.useState)(!0),[w,A]=(0,a.useState)(null),[k,E]=(0,a.useState)(!1),[L,C]=(0,a.useState)(!1),[P,R]=(0,a.useState)(""),[M,D]=(0,a.useState)(!1),[S,F]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=async()=>{y(!0),A(null);try{let[e,s]=await Promise.all([j.i.getApplication(t),j.i.getLoanPaymentHistory(t,{limit:50})]);N(e),v(s.payments||[])}catch(t){var e,s;console.error("Failed to fetch loan:",t),A((null==t||null==(s=t.response)||null==(e=s.data)?void 0:e.message)||(null==t?void 0:t.message)||"Failed to load loan application.")}finally{y(!1)}};t&&e()},[t]);let I=async()=>{E(!0),F("approve");try{await j.i.approveLoan(t),D(!0)}catch(t){var e,s;console.error("Failed to approve loan:",t),A((null==t||null==(s=t.response)||null==(e=s.data)?void 0:e.message)||(null==t?void 0:t.message)||"Failed to approve loan.")}finally{E(!1)}},B=async()=>{if(!P.trim())return void alert("Please provide a rejection reason");E(!0),F("reject");try{await j.i.rejectLoan(t,P),C(!1),D(!0)}catch(t){var e,s;console.error("Failed to reject loan:",t),A((null==t||null==(s=t.response)||null==(e=s.data)?void 0:e.message)||(null==t?void 0:t.message)||"Failed to reject loan.")}finally{E(!1)}},_=()=>{s.push("/admin/applications")};if(f)return(0,l.jsx)(i.A,{children:(0,l.jsx)("div",{className:"py-8 sm:py-12 md:py-16 lg:py-20 bg-white",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-4 border-cyan-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Loading application..."})]})})});if(w)return(0,l.jsx)(i.A,{children:(0,l.jsx)("div",{className:"py-8 sm:py-12 md:py-16 lg:py-20 bg-white",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,l.jsx)(r.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Error Loading Application"}),(0,l.jsx)("p",{className:"text-slate-600 mb-4",children:w}),(0,l.jsx)("button",{onClick:_,className:"px-6 py-3 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors",children:"Back to Applications"})]})})});if(!u)return(0,l.jsx)(i.A,{children:(0,l.jsx)("div",{className:"py-8 sm:py-12 md:py-16 lg:py-20 bg-white",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,l.jsx)(r.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Application Not Found"}),(0,l.jsx)("p",{className:"text-slate-600",children:"The loan application you're looking for doesn't exist."})]})})});if(M)return(0,l.jsx)(i.A,{children:(0,l.jsx)("div",{className:"py-8 sm:py-12 md:py-16 lg:py-20 bg-white",children:(0,l.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 p-8 sm:p-12",children:["approve"===S?(0,l.jsx)(c.A,{className:"w-16 h-16 text-green-500 mx-auto mb-6"}):(0,l.jsx)(d.A,{className:"w-16 h-16 text-red-500 mx-auto mb-6"}),(0,l.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:"approve"===S?"Application Approved!":"Application Rejected"}),(0,l.jsx)("p",{className:"text-slate-600 mb-8",children:"approve"===S?"Loan application ".concat(u.id," has been approved successfully."):"Loan application ".concat(u.id," has been rejected.")}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("button",{onClick:_,className:"w-full px-6 py-3 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors",children:"Back to Applications"}),(0,l.jsx)("button",{onClick:()=>D(!1),className:"w-full px-6 py-3 bg-slate-100 text-slate-700 font-semibold rounded-lg hover:bg-slate-200 transition-colors",children:"Review Another Application"})]})]})})})});let O=(0,b.DY)(u.status);return(0,l.jsxs)(i.A,{children:[(0,l.jsx)("div",{className:"py-8 sm:py-12 md:py-16 lg:py-20 bg-white",children:(0,l.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8 sm:mb-12",children:[(0,l.jsxs)("button",{onClick:_,className:"inline-flex items-center gap-2 text-cyan-600 hover:text-cyan-700 mb-4 transition-colors",children:[(0,l.jsx)(o.A,{className:"w-4 h-4"}),"Back to Applications"]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-3 sm:mb-4",children:"Review Application"}),(0,l.jsxs)("p",{className:"text-sm sm:text-base text-slate-600",children:["Application ID: ",u.id]})]}),(0,l.jsx)("div",{className:"flex items-center gap-3",children:(0,l.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ".concat(O.bgColor," ").concat(O.color),children:[O.icon&&(0,l.jsx)(O.icon,{className:"w-4 h-4"}),O.label]})})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12",children:[(0,l.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 sm:p-8",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,l.jsx)(x.A,{className:"w-6 h-6 text-cyan-600"}),"Loan Details"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Loan Amount"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(0,b.vv)(u.amount)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Purpose"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.purpose})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Loan Term"}),(0,l.jsxs)("p",{className:"text-lg font-semibold text-slate-900",children:[u.term," months"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Interest Rate"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.interestRate})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Applied Date"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:(0,b.Yq)(u.createdAt)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Monthly Payment"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:(0,b.vv)(u.monthlyPayment)})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 sm:p-8",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,l.jsx)(m.A,{className:"w-6 h-6 text-cyan-600"}),"Applicant Information"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Full Name"}),(0,l.jsxs)("p",{className:"text-lg font-semibold text-slate-900",children:[u.user.firstName," ",u.user.lastName]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Email"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.user.email})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Phone"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.user.phone})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Date of Birth"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.user.dateOfBirth})]}),(0,l.jsxs)("div",{className:"sm:col-span-2",children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Address"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.user.address})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 sm:p-8",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,l.jsx)(p,{className:"w-6 h-6 text-cyan-600"}),"Employment Information"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Employer"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.employerName})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Position"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.position})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Monthly Income"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:(0,b.vv)(u.monthlyIncome)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Employment Duration"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:u.employmentDuration})]})]})]}),"ACTIVE"===u.status&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 sm:p-8",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,l.jsx)(h.A,{className:"w-6 h-6 text-cyan-600"}),"Payment History"]}),0===g.length?(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(h.A,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:"No payments made yet for this loan."})]}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Paid"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(0,b.vv)(g.reduce((e,s)=>e+s.amount,0))})]}),(0,l.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Payments Made"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:g.length})]}),(0,l.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,l.jsx)("p",{className:"text-slate-600 text-sm",children:"Remaining Balance"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(0,b.vv)((u.amount||0)-g.reduce((e,s)=>e+s.amount,0))})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-slate-600 border-b border-slate-200",children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left",children:"Date"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left",children:"Amount"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left",children:"Type"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left",children:"Status"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left",children:"Method"})]})}),(0,l.jsx)("tbody",{children:g.map(e=>(0,l.jsxs)("tr",{className:"border-b border-slate-100",children:[(0,l.jsx)("td",{className:"px-4 py-3",children:(0,b.Yq)(e.paidAt||e.dueDate)}),(0,l.jsx)("td",{className:"px-4 py-3 font-semibold",children:(0,b.vv)(e.amount)}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.type.replace("_"," ")}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat("COMPLETED"===e.status?"bg-green-50 text-green-600":"PENDING"===e.status?"bg-yellow-50 text-yellow-600":"bg-red-50 text-red-600"),children:e.status})}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.paymentMethod||"N/A"})]},e.id))})]})})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:["PENDING"===u.status&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Review Actions"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("button",{onClick:I,disabled:k,className:"w-full px-4 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:k&&"approve"===S?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.A,{className:"w-5 h-5"}),"Approve Loan"]})}),(0,l.jsxs)("button",{onClick:()=>C(!0),disabled:k,className:"w-full px-4 py-3 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:[(0,l.jsx)(d.A,{className:"w-5 h-5"}),"Reject Loan"]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Application Status"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Status:"}),(0,l.jsx)("span",{className:"font-semibold ".concat(O.color),children:O.label})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Applied:"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:(0,b.Yq)(u.createdAt)})]}),u.updatedAt&&u.updatedAt!==u.createdAt&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-600",children:"Last Updated:"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:(0,b.Yq)(u.updatedAt)})]})]})]})]})]})]})}),L&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 sm:p-8 max-w-md w-full",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Reject Application"}),(0,l.jsx)("p",{className:"text-slate-600 mb-4",children:"Please provide a reason for rejecting this loan application."}),(0,l.jsx)("textarea",{value:P,onChange:e=>R(e.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-colors resize-none"}),(0,l.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-2 bg-slate-100 text-slate-700 font-semibold rounded-lg hover:bg-slate-200 transition-colors",children:"Cancel"}),(0,l.jsx)("button",{onClick:B,disabled:k||!P.trim(),className:"flex-1 px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:k?"Rejecting...":"Reject"})]})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[981,360,74,388,441,684,358],()=>s(74484)),_N_E=e.O()}]);