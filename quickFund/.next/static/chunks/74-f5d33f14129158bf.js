"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{7283:(e,t,s)=>{s.d(t,{O5:()=>i,Tp:()=>c,uE:()=>o});var a=s(22909);let r=()=>"/api/v1";class l{static getInstance(){return l.instance||(l.instance=new l),l.instance}setToken(e){this.accessToken=e}getToken(){return this.accessToken}clearToken(){this.accessToken=null}constructor(){this.accessToken=null}}let n=l.getInstance(),o=(()=>{let e=a.A.create({baseURL:r(),timeout:1e4,headers:{"Content-Type":"application/json"},withCredentials:!0});return e.interceptors.request.use(e=>{let t=n.getToken();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),e.interceptors.response.use(e=>e,async t=>{var a;let r=t.config;if((null==(a=t.response)?void 0:a.status)===401&&!r._retry){r._retry=!0;try{let{authApi:t}=await Promise.resolve().then(s.bind(s,22370)),a=await t.refreshToken();return r.headers.Authorization="Bearer ".concat(a.accessToken),e(r)}catch(e){return n.clearToken(),sessionStorage.removeItem("quickfund-refresh-token"),Promise.reject(e)}}return Promise.reject(t)}),e})(),i=e=>{n.setToken(e)},c=()=>{n.clearToken()}},22370:(e,t,s)=>{s.d(t,{authApi:()=>o});var a=s(7283);let r=()=>sessionStorage.getItem("quickfund-refresh-token"),l=e=>{sessionStorage.setItem("quickfund-refresh-token",e)},n=()=>{sessionStorage.removeItem("quickfund-refresh-token")},o={login:async e=>{let t=await a.uE.post("/auth/login",e);return(0,a.O5)(t.data.accessToken),l(t.data.refreshToken),t.data},register:async e=>(await a.uE.post("/auth/register",e)).data,getProfile:async()=>(await a.uE.get("/auth/profile")).data.user,refreshToken:async e=>{let t=r();if(!t)throw Error("No refresh token available");let s=await a.uE.post("/auth/refresh",{refreshToken:t});return(0,a.O5)(s.data.accessToken),l(s.data.refreshToken),s.data},logout:async e=>{try{await a.uE.post("/auth/logout",{sessionId:e})}catch(e){console.warn("Logout request failed, but clearing local tokens:",e)}finally{(0,a.Tp)(),n()}},validateToken:async()=>{try{return await a.uE.get("/auth/profile"),!0}catch(e){return!1}},changePassword:async(e,t)=>{await a.uE.put("/auth/change-password",{currentPassword:e,newPassword:t})},forgotPassword:async e=>{await a.uE.post("/auth/forgot-password",{email:e})},resetPassword:async(e,t)=>{await a.uE.post("/auth/reset-password",{token:e,newPassword:t})}},{login:i,register:c,getProfile:d,refreshToken:u,logout:h,validateToken:m,changePassword:x,forgotPassword:f,resetPassword:g}=o},52074:(e,t,s)=>{s.d(t,{default:()=>w});var a=s(95155),r=s(12115),l=s(6874),n=s.n(l),o=s(35695),i=s(97126),c=s(75411),d=s(78119),u=s(60700),h=s(17576),m=s(83459),x=s(73400),f=s(95309),g=s(7283);let p={getMyNotifications:async()=>(await g.uE.get("/notifications")).data,markAsRead:async e=>{await g.uE.patch("/notifications/".concat(e,"/read"))},markAllAsRead:async()=>{await g.uE.patch("/notifications/read-all")}};function b(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!1),[n,o]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{d()},[]);let d=async()=>{o(!0),c(null);try{let e=await p.getMyNotifications();t(e)}catch(e){c(e.message||"Failed to load notifications")}finally{o(!1)}},u=async e=>{try{await p.markAsRead(e),t(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(e){}},h=async()=>{try{await p.markAllAsRead(),t(e=>e.map(e=>({...e,read:!0})))}catch(e){}},m=Array.isArray(e)?e:[],g=m.filter(e=>!e.read).length;return(0,a.jsxs)("div",{className:"relative inline-block text-left",children:[(0,a.jsxs)("button",{className:"relative p-2 rounded-full hover:bg-slate-100 focus:outline-none",onClick:()=>l(e=>!e),"aria-label":"Notifications",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-slate-600"}),g>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5",children:g})]}),s&&(0,a.jsxs)("div",{className:"origin-top-right absolute right-0 mt-2 w-80 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-slate-100 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:"Notifications"}),g>0&&(0,a.jsx)("button",{onClick:h,className:"text-xs text-cyan-600 hover:underline",children:"Mark all as read"})]}),(0,a.jsx)("div",{className:"max-h-80 overflow-y-auto divide-y divide-slate-100",children:n?(0,a.jsx)("div",{className:"p-4 text-center text-slate-500 text-sm",children:"Loading..."}):i?(0,a.jsx)("div",{className:"p-4 text-center text-red-500 text-sm",children:i}):0===m.length?(0,a.jsx)("div",{className:"p-4 text-center text-slate-500 text-sm",children:"No notifications"}):m.map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-3 px-4 py-3 ".concat(e.read?"bg-white":"bg-cyan-50"),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm text-slate-900 mb-1",children:e.message}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:new Date(e.createdAt).toLocaleString()})]}),!e.read&&(0,a.jsx)("button",{onClick:()=>u(e.id),className:"ml-2 p-1 text-cyan-600 hover:bg-cyan-100 rounded-full",title:"Mark as read",children:(0,a.jsx)(f.A,{className:"w-4 h-4"})})]},e.id))})]})]})}let y=()=>(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-1.5",children:[(0,a.jsx)("span",{className:"block h-0.5 w-5 rounded-full bg-slate-900"}),(0,a.jsx)("span",{className:"block h-0.5 w-8 rounded-full bg-slate-900"}),(0,a.jsx)("span",{className:"block h-0.5 w-5 rounded-full bg-slate-900"})]});function w(){var e;let t=(0,o.usePathname)(),s=(0,o.useRouter)(),{user:l,isAuthenticated:x,logout:f,success:g,clearSuccess:p}=(0,m.nc)(),[w,v]=(0,r.useState)(!1),[j,N]=(0,r.useState)(null),[k,A]=(0,r.useState)(null),[L,T]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w?document.body.style.overflow="hidden":document.body.style.overflow="unset"},[w]);let C=e=>{let t=document.getElementById(e);if(t){let e=t.offsetTop-80;window.scrollTo({top:e,behavior:"smooth"})}v(!1),A(null)},S=(e,s)=>{e.preventDefault(),"/"===s?"/"===t?window.scrollTo({top:0,behavior:"smooth"}):window.location.href="/":s.startsWith("#")?C(s.substring(1)):window.location.href=s},I=e=>{k===e?A(null):A(e)},E=e=>{e.startsWith("#")?"/"!==t?window.location.href="/".concat(e):C(e.substring(1)):window.location.href=e,A(null)},P=async()=>{try{await f(),T(!1),s.push("/")}catch(e){console.error("Logout error:",e)}},z=[{href:"/",label:"Home"},{href:"#",label:"Products",dropdown:[{href:"#loan-types",label:"Loan Types"},{href:"#features",label:"Features"},{href:"#how-it-works",label:"How It Works"}]},{href:"/about",label:"About"},{href:"/faqs",label:"FAQ"}],F=[{href:"/user",label:"Dashboard"},{href:"/user/loans",label:"My Loans"},{href:"/user/apply",label:"Apply for Loan"}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("header",{className:"bg-white/70 backdrop-blur-md sticky top-0 z-30 border-b border-gray-200 shadow-sm",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[(0,a.jsx)(n(),{href:"/",className:"text-2xl font-bold text-slate-900 tracking-tight",children:"QuickFund"}),(0,a.jsx)("nav",{className:"hidden lg:flex items-center space-x-8",children:z.map(e=>(0,a.jsx)("div",{className:"relative",children:e.dropdown?(0,a.jsxs)("div",{className:"relative group",onMouseEnter:()=>N(e.label),onMouseLeave:()=>N(null),children:[(0,a.jsxs)("button",{onClick:()=>I(e.label),className:"flex items-center space-x-1 text-sm font-medium transition-all duration-300 ease-in-out hover:scale-105 cursor-pointer text-slate-700 hover:text-cyan-600",children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)(i.A,{className:(0,h.A)("w-4 h-4 transition-transform duration-200",j===e.label||k===e.label?"rotate-180":"")})]}),(j===e.label||k===e.label)&&(0,a.jsx)("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:e.dropdown.map(e=>(0,a.jsx)("button",{onClick:()=>E(e.href),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-cyan-600 transition-colors duration-200",children:e.label},e.href))})]}):(0,a.jsxs)("a",{href:e.href,onClick:t=>S(t,e.href),className:(0,h.A)("relative text-sm font-medium transition-all duration-300 ease-in-out hover:scale-105 group cursor-pointer",t===e.href?"text-cyan-600 font-semibold":"text-slate-700 hover:text-cyan-600"),children:[e.label,(0,a.jsx)("span",{className:(0,h.A)("absolute -bottom-1 left-0 h-0.5 bg-cyan-600 transition-all duration-300 ease-in-out",t===e.href?"w-full":"w-0 group-hover:w-full")})]})},e.href))}),(0,a.jsx)("div",{className:"hidden lg:flex items-center space-x-4",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b,{}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>T(!L),className:"flex items-center space-x-2 text-sm font-medium text-slate-700 hover:text-cyan-600 transition-colors duration-200",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:(null==l||null==(e=l.firstName)?void 0:e[0])||(0,a.jsx)(c.A,{className:"w-5 h-5"})})}),(0,a.jsx)("span",{children:null==l?void 0:l.firstName}),(0,a.jsx)(i.A,{className:"w-4 h-4"})]}),L&&(0,a.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[null==l?void 0:l.firstName," ",null==l?void 0:l.lastName]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:null==l?void 0:l.email})]}),(0,a.jsx)("div",{className:"py-1",children:F.map(e=>(0,a.jsx)(n(),{href:e.href,onClick:()=>T(!1),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-cyan-600 transition-colors duration-200",children:e.label},e.href))}),(0,a.jsx)("div",{className:"border-t border-gray-100 pt-1",children:(0,a.jsxs)("button",{onClick:P,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{href:"/login",className:"px-4 py-2 text-sm font-medium text-cyan-600 hover:text-cyan-700 rounded-lg border border-cyan-100 hover:border-cyan-200 transition-colors",children:"Sign In"}),(0,a.jsx)(n(),{href:"/signup",className:"px-4 py-2 text-sm font-semibold text-white bg-cyan-600 hover:bg-cyan-700 rounded-lg shadow transition-colors",children:"Get Started"})]})}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsx)("button",{onClick:()=>v(!0),"aria-label":"Open menu",children:(0,a.jsx)(y,{})})})]})}),(0,a.jsx)("div",{className:(0,h.A)("fixed inset-0 z-40 bg-black/30 backdrop-blur-sm transition-opacity duration-300 ease-in-out lg:hidden",w?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>v(!1),"aria-hidden":"true"}),(0,a.jsxs)("div",{className:(0,h.A)("fixed top-4 right-4 z-50 w-full max-w-sm rounded-xl bg-white/80 backdrop-blur-md border border-white/20 p-6 shadow-2xl transition-transform duration-300 ease-in-out lg:hidden",w?"translate-x-0":"translate-x-[110%]"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Menu"}),(0,a.jsx)("button",{onClick:()=>v(!1),"aria-label":"Close menu",children:(0,a.jsx)(u.A,{className:"h-6 w-6 text-slate-700"})})]}),(0,a.jsxs)("nav",{className:"flex flex-col space-y-4",children:[z.map(e=>(0,a.jsx)("div",{children:e.dropdown?(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>I(e.label),className:"flex items-center justify-between w-full text-base font-medium text-slate-700 mb-2 hover:text-cyan-600 transition-colors duration-200",children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)(i.A,{className:(0,h.A)("w-4 h-4 transition-transform duration-200",k===e.label?"rotate-180":"")})]}),k===e.label&&(0,a.jsx)("div",{className:"ml-4 space-y-2",children:e.dropdown.map(e=>(0,a.jsx)("button",{onClick:()=>E(e.href),className:"block w-full text-left text-sm text-gray-600 hover:text-cyan-600 transition-colors duration-200",children:e.label},e.href))})]}):(0,a.jsxs)("a",{href:e.href,onClick:t=>S(t,e.href),className:(0,h.A)("relative text-base font-medium transition-all duration-300 ease-in-out hover:scale-105 hover:translate-x-2 group cursor-pointer",t===e.href?"text-cyan-600 font-semibold":"text-slate-700 hover:text-cyan-600"),children:[e.label,(0,a.jsx)("span",{className:(0,h.A)("absolute -bottom-1 left-0 h-0.5 bg-cyan-600 transition-all duration-300 ease-in-out",t===e.href?"w-full":"w-0 group-hover:w-full")})]})},e.href)),(0,a.jsx)("hr",{className:"my-4"}),x?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[null==l?void 0:l.firstName," ",null==l?void 0:l.lastName]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:null==l?void 0:l.email})]}),F.map(e=>(0,a.jsx)(n(),{href:e.href,onClick:()=>v(!1),className:"block text-base font-medium text-slate-700 hover:text-cyan-600 transition-colors duration-200",children:e.label},e.href)),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)("button",{onClick:()=>{v(!1),P()},className:"flex items-center w-full text-base font-medium text-red-600 hover:text-red-700 transition-colors duration-200",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(n(),{href:"/login",onClick:()=>v(!1),className:"block text-base font-medium text-slate-700 hover:text-cyan-600 transition-colors duration-200",children:"Login"}),(0,a.jsx)(n(),{href:"/signup",onClick:()=>v(!1),className:"block w-full px-4 py-3 bg-cyan-600 text-white text-base font-semibold rounded-lg hover:bg-cyan-700 transition-colors duration-200 text-center",children:"Get Started"})]})]})]}),L&&(0,a.jsx)("div",{className:"fixed inset-0 z-20",onClick:()=>T(!1)})]})}},83459:(e,t,s)=>{s.d(t,{nc:()=>d});var a=s(38942),r=s(95086),l=s(22370),n=s(7283),o=s(83827);let i=()=>sessionStorage.getItem("quickfund-refresh-token"),c=()=>{sessionStorage.removeItem("quickfund-refresh-token")},d=(0,a.v)()((0,r.Zr)((e,t)=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,success:null,sessionId:null,setLoading:t=>e({isLoading:t}),clearError:()=>e({error:null}),clearSuccess:()=>e({success:null}),setUser:t=>e({user:t,isAuthenticated:!0,error:null}),login:async t=>{e({isLoading:!0,error:null,success:null});try{let s=await l.authApi.login(t),a=null;try{s.accessToken&&(a=(0,o.s)(s.accessToken).sessionId||void 0)}catch(e){console.warn("Failed to decode JWT for sessionId:",e)}e({user:s.user,isAuthenticated:!0,isLoading:!1,error:null,success:"Login successful! Welcome back.",sessionId:a})}catch(t){var s,a;throw e({isLoading:!1,error:(null==(a=t.response)||null==(s=a.data)?void 0:s.message)||"Login failed",success:null,sessionId:null}),t}},register:async t=>{e({isLoading:!0,error:null,success:null});try{await l.authApi.register(t),e({user:null,isAuthenticated:!1,isLoading:!1,error:null,success:"Account created successfully! Please sign in to continue."})}catch(t){var s,a;throw e({isLoading:!1,error:(null==(a=t.response)||null==(s=a.data)?void 0:s.message)||"Registration failed",success:null}),t}},logout:async()=>{e({isLoading:!0,error:null,success:null});let s=t().sessionId;try{await l.authApi.logout("string"==typeof s&&s?s:void 0)}catch(e){console.warn("Logout error:",e)}finally{(0,n.Tp)(),c(),e({user:null,isAuthenticated:!1,isLoading:!1,error:null,success:"Logged out successfully. Come back soon!",sessionId:null})}},getProfile:async()=>{e({isLoading:!0,error:null,success:null});try{let t=await l.authApi.getProfile();e({user:t,isAuthenticated:!0,isLoading:!1,error:null,success:null})}catch(a){var t,s;throw e({isLoading:!1,error:(null==(s=a.response)||null==(t=s.data)?void 0:t.message)||"Failed to get profile",success:null}),a}},initialize:async()=>{e({isLoading:!0});try{if(!i())return void e({user:null,isAuthenticated:!1,isLoading:!1,error:null,success:null});await l.authApi.refreshToken();let t=await l.authApi.getProfile();e({user:t,isAuthenticated:!0,isLoading:!1,error:null,success:null})}catch(t){console.warn("Session refresh failed or expired:",(null==t?void 0:t.message)||t),(0,n.Tp)(),c(),e({user:null,isAuthenticated:!1,isLoading:!1,error:null,success:null})}}}),{name:"quickfund-auth",storage:(0,r.KU)(()=>({getItem:e=>{try{return localStorage.getItem(e)}catch(e){return null}},setItem:(e,t)=>{try{localStorage.setItem(e,t)}catch(e){console.warn("Failed to persist auth state:",e)}},removeItem:e=>{try{localStorage.removeItem(e)}catch(e){console.warn("Failed to remove auth state:",e)}}})),partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,error:e.error,success:e.success})}))}}]);